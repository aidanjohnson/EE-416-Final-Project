clear vars;
close all;

% x = [0,1,2,3,4,5,4,3,2,1,0];
% xn = x + randn(1,length(x));
% y = conv(xn,x);

% figure;
% subplot(1,3,1);
% plot(x); 
% subplot(1,3,2);
% plot(xn);
% subplot(1,3,3); 
% plot(y);

% x3 = [x,x,x];
% x3n = x3 + randn(1,length(x3));
% y3 = conv(x, x3n);
% 
% figure; 
% subplot(1,3,1); 
% plot(x3); 
% subplot(1,3,2); 
% plot(x3n); 
% subplot(1,3,3); 
% plot(y3);

% x9 = [x,-x,x,-x,x,-x,x,-x,x];
% x9n = x9 + randn(1,length(x9));
% y9 = conv(x, x9n);
% y9_mag = abs(y9);
% 
% figure; 
% subplot(1,3,1); 
% plot(x9); 
% subplot(1,3,2); 
% plot(x9n); 
% subplot(1,3,3); 
% plot(y9);

r = [14.4342234279396;1.76739807010410;3.38737211619243;15.3902634840510;7.20334919480770;-1.86990621611162;-15.3372826137602;-17.3199567301238;-47.6521291254464;-18.1435607036759;1.75242168495039;-18.4252426935510;-17.9911915163001;-11.4765936822521;-30.7834826302005;-12.3423608867940;-43.4793549753733;-11.6250250501254;-23.1502242339098;-27.5152011666773;-18.9818345090707;-12.6250264434308;-35.0832710064077;-26.4527864813580;-19.2636914631976;-0.0888908494088554;-42.3334216573588;-28.7263984747293;-27.4191377637238;1.55087523777372;-18.9196963992442;-51.3517720946135;-46.4507883701745;-22.0485241830005;-15.5386341743700;-32.4538601041181;-28.0494411076194;-50.6940133141499;-44.1694421457041;-38.3429159924340;-50.8885331483120;-48.7214372191869;-90.9836314760743;-19.5177675010401;-11.8653794682088;-59.6196599614052;-27.1458741674518;-32.9319280673683;-82.9884157681036;-77.3614513977310;-33.1916326059726;-29.5102535273329;-21.7875222059443;-79.1256975821225;-32.6957779085058;-34.9148326491446;-57.8967797471200;-50.8080613808767;-66.9148280787902;-74.4194319185203;-37.9016258197947;-32.5866163568328;-40.7861898190865;-41.6237432177443;-52.3814967379671;-67.3621987862600;-43.5437788292544;-35.6529679526201;-44.6452699839374;-46.3337023976789;-65.0814392614276;-61.9687975074558;-19.6025005140460;-56.2067195812793;-9.98342483279803;-29.5959143956232;-5.76508084767329;-76.2096940680292;-33.3048718943657;-50.1771175844868;-12.2841227369040;5.59627807029804;-11.9380616521255;-30.9585277091147;-41.5350615727286;-65.2451949296553;15.2930340005637;2.45138173041662;-26.7418946614049;-16.2147407396528;-39.2310237353291;-33.4021095594733;-11.0450757290900;8.80634568113714;-9.81887625743923;20.0334272594912;-4.28641926120664;-31.5871220657863;-30.4665286312301;0.821457080294204;-37.4050510648830;-3.08897428327832;-23.5987369293260;29.2916367810046;-8.24065659352729;-3.98357636519523;-49.3402683154847;-28.5748036535214;-30.9229096338026;0.949562506683805;9.21428579943691;-19.2017817231140;-10.8800948845912;-20.5582958320131;-19.8958727228750;-31.8082922172712;-41.6422033086064;-15.6391553461285;-12.6935949225437;-9.39941394608817;-18.0220229606064;-7.56764579376979;-37.4171270040038;-35.6370352010570;-30.0933216415106;-29.8532487938639;-29.8306288363668;-59.2056718280486;-46.6325949056255;-35.1546280597485;-57.1698759136795;-65.1810826874593;-38.9758844874485;-30.0102546828225;-25.7442022557978;-70.1347590318789;-46.9704143192375;-45.7566645433303;-64.1427117274683;-37.0679241934396;-11.8840842648153;-44.1946379178786;-27.9961547943314;-19.1418043714224;-59.3551214486127;-10.4396772935269;-69.4772428675490;-51.4103343914991;-77.2027265553308;-68.9736678872087;-56.6285383448020;-45.7554067410760;-24.4472117363010;-69.3964053420372;-29.1008124923421;-72.0070580645880;-73.5891044788470;-48.7783436956863;-32.4234447638239;-58.9391317449386;-91.4564031683810;-62.7394413071587;-36.0605298635899;-62.2361680717971;-45.0116526175314;-68.1696770309950;-97.8007832174119;-56.4383257127669;-74.4747875987026;-106.327775916101;-46.6404925862693;-68.2157148746969;-72.8520599680502;-67.1634595200977;-46.7613362618592;-54.0819686824516;-81.4503089669010;-93.9674940016427;-107.029736112329;-67.7911671135654;-59.4752334206323;-62.0407855513346;-88.2434282148865;-93.7626755287782;-76.5731526535209;-66.2650098999370;-58.9957624620698;-36.3420313401694;-51.0005798730624;-94.2559474012417;-93.0556283782678;-62.9112316734826;-50.1110007746685;-93.8843001603279;-93.2476158155217;-92.7484858483293;-98.3782039846681;-65.8808659662437;-60.6126096191545;-74.7674405188135;-91.2862901584077;-51.8659429359784;-57.0830410633695;-83.2498999982232;-83.2913756131147;-93.0283691504810;-33.7791626422035;-31.2112224992860;-53.0112935797476;-40.5915210666477;-50.8179875737548;-49.1332462226996;-48.8114548180590;-27.6228594332100;-54.8047773931362;-56.6099879967758;-37.7626551430329;-53.0228117067223;-41.0311486577373;-25.0560524101494;-40.3631520109399;-33.2573882075644;-16.7526571738808;-15.2811590555134;-81.6644550035545;-37.1687888578551;-33.4084180347594;-50.0771397329682;-44.5457571188802;-57.2769589082702;-62.0784621138835;-36.4043573456252;-56.8420336709837;1.85552139060432;-40.7554271307933;-52.7290283731341;-8.51235717467300;-62.9554871185478;-39.8162042958024;-30.2048694934688;-1.35396045966349;-15.9123763937807;-24.5489861564467;-21.3216493474271;-15.6546942392613;-19.5040094444296;-14.5584479380759;-24.9651231456095;-47.9436852032790;-65.0828192537040;-95.7360399722416;-44.1630994318806;-19.6255914799873;-56.2290912379056;-47.6028406920893;-22.3236937741980;-43.4141134196837;-91.5976544285222;-74.1674280695464;-42.3444218619174;-78.6465304088911;-39.2304142516431;-61.6258838332842;-34.2254336114654;-84.7646913836370;-49.7302638270691;-58.8000808855798;-55.8888081423311;-54.1788998822672;-50.1831419013002;-79.1662729393909;-78.3002734261956;-77.3256945328512;-70.2887580631877;-31.3143411650811;-43.5563900271530;-48.8627634583497;-64.5049560102424;-61.7768185023968;-80.3845352204635;-51.1304019488959;-33.3565296549860;-59.6968277058034;-59.6488351563962;-96.1845657347825;-56.2231235046772;-90.3158424849600;-71.3855483004120;-71.5537432203721;-66.8577875657082;-66.4463000809978;-76.7073632465161;-76.9588919353808;-49.5076464253644;-107.434135832850;-77.8138985129625;-87.7305278802343;-108.016984960093;-102.908027730540;-30.4157252797260;-114.331314440750;-75.6165832376275;-90.5435426943317;-66.7710738893331;-51.4516695749542;-81.6341023590556;-93.1260885389779;-80.0041609229662;-52.6124081266355;-95.4435185438211;-94.9586973094334;-119.252582966067;-90.1802086679504;-119.661501868950;-67.9849430295870;-93.3635724051471;-101.555958761031;-76.4949581406403;-139.256133790564;-110.346138154856;-78.2294669139437;-98.8444280137039;-57.3390156522931;-92.3063597140035;-78.3647945068240;-77.9459024569318;-83.9587040191687;-47.1576985596846;-87.4817576345749;-107.625161447038;-98.1555288597123;-84.4174991645600;-65.3762909310117;-93.0619414291149;-79.0705623546862;-80.4010809328714;-91.4954355189054;-43.6521894834835;-64.6776480394311;-92.5073678239573;-70.0508025550699;-53.6808788423544;-88.3567953995009;-38.5171823644039;-63.7415669956960;-76.7643906941223;-97.3015688418562;-62.2565742396119;-130.514648601272;-74.0319396429880;-80.4013875882419;-32.7226817124010;-23.3581034391344;-90.1685416107577;-65.6180810249996;-85.2454049985683;-47.3892097354531;-67.7540171260077;-80.5478865944930;-24.3002901124576;-66.1856016948103;-63.5475068961442;-47.3139461977934;-22.3210312675531;-37.7836248189259;-53.4143223300191;-38.0957950152730;-65.0953094452187;-24.8063179975474;-69.4066608065234;-32.8211303625428;-58.3871085394742;-12.1092506483017;-13.6427863981299;-49.0790552343975;-37.7230004854412;-81.5396544155506;-38.6653119102111;-49.4175408192049;-81.7523250326467;-46.3416540527081;-45.8090442147981;-68.8157765452331;-76.5165360156113;-33.2496015699214;-25.3831903255020;-55.8770557212059;-39.2460827671461;-25.4036380292087;-42.5464392780938;-52.6774237845730;-85.4634246458483;-61.1151425411052;-42.9512160968473;-58.6672395104367;-50.7364274606128;-62.5075220529003;-53.4144406056105;-54.1077954589489;-72.9985767561372;-63.1217045971286;-71.5607945366262;-61.3016003999091;-24.5540291521526;-86.6806134878260;-61.9559179644435;-78.5099859242290;-63.0429736874140;-56.5504756625975;-76.7601378841756;-47.7405326006129;-77.4891560047767;-81.4480480196382;-68.6487592697226;-73.1747937887616;-22.7275638322600;-57.7644650969140;-54.9085417432417;-110.239569140674;-92.1623745581160;-109.560348405597;-25.7558542151666;-125.763709507342;-90.9848421840580;-53.8132768144428;-112.887785296286;-92.9546284631551;-61.0271222775808;-70.4379302475000;-53.7720568502324;-54.5893458189186;-57.0169775520246;-67.0549572731053;-63.7435076136641;-87.7214472017620;-91.2948282525472;-99.6135286294810;-60.1690772078508;-67.3047526520222;-59.7847110328284;-25.1512669773707;-32.1116701045923;-51.7687223206457;-69.3432736137627;-90.6782600387312;-41.2965862469244;-23.4000734079885;-72.1428529185712;-52.2662657213405;-36.1359647165281;-49.6895863209708;-41.0453931698396;-75.9499358622363;-19.2943457698910;-68.6441209357311;-83.6209275926457;-84.6048070366549;-12.8214524553410;-81.6492434744719;-23.9384026273217;-24.6668780771442;-54.0581952945526;-63.4596638959711;-4.39970643265834;-19.2998486632435;-45.2138027298626;-30.5348192971357;-54.8830857751038;-39.1518648390457;-36.9243516896185;-44.7435821554609;-40.3670714786273;-27.5559855756371;-29.8526176485445;-33.9506055324276;-49.5450260835326;-32.1091354063174;-26.8432361308888;-21.8036146593739;-13.5034456977826;-6.34276237796409;-24.0878951346376;-32.0971245961249;-25.5358000937184;-36.0060075026681;-18.8890884240584;-33.2088109279728;-28.9312892442478;10.6788446536782;-16.3037383982679;-12.2753078383512;-22.1628999534016;22.9770648932401;7.56265748964225;-37.4253305576562;-35.2488585965271;0.260811618708370;-8.97851119729245;29.6357069173125;-44.0549287478685;11.7366389265947;-12.3662232296539;-1.07551822863550;-6.37891070082281;-27.0999675625393;-25.7854284143010;-25.2885576973517;7.60644600712900;-16.1996246542882;-18.5102614365824;1.03926675025130;-38.0080228389753;-17.3805579929107;-6.28410958706647;-21.9319190750142;37.9237932224161;29.8167662671874;-11.3922400099589;45.4312772087451;16.7232988211467;7.13632950519998;15.6661359051738;0.763498902079970;30.1646674115777;22.0223395527436;33.3407485856801;40.4450182793480;2.69249843548623;35.2014706232463;-21.4921679567111;18.0983439449049;23.0291082559101;-1.84761564306220;16.6590697640795;17.8203176999160;11.7005319913311;56.3892966806062;36.5966484126002;33.6624259211800;54.9279053799638;51.4237146398221;12.4651074573575;9.66293242087283;0.132746570414056;-19.6597295154146;43.7648136287499;-17.3984884561397;46.2547456293206;74.7624763923009;36.4230961388953;41.5031914954168;23.8173972302620;31.6447085831204;38.5673054347408;20.5466072932574;1.56706827656365;-27.2011505882763;34.6657655075277;9.14363223623600;7.57123984325364;5.74092065738842;40.3335327118546;-7.92387326920330;5.52223283952515;-14.3377045657254;7.75776596473410;17.0527805560893;9.51202074862768;31.7463502269100;-2.58076385211402;10.2746979271681;13.3589149184579;-8.55229562559622;-5.67988306028290;11.3839746424261;5.54606050656692;-0.860752459739267;-0.870457399145566;-3.65183083222278;34.4390411779950;-9.01731859076218;4.57114597758858;19.6641370433470;-21.5708119695543;-37.9893333464078;-5.48243907559354;-6.41924321947900;-18.6086059106414;-27.8735885925282;-26.3689997277641;-1.64940491873255;0.975314806356192;-9.45804092955464;-27.6300831583865;-2.20073706100751;-24.0677338310163;-15.8549970241318;-17.0486630457398;-17.7331002306174;-50.9709408012295;-27.8049105787628;-8.66203924901463;-28.9496389005798;-29.1314656497063;-36.6105196975398;-32.3688205182366;-7.30686854040041;-50.3082317594509;-28.6607088976093;-74.4213479139255;-0.293017921915350;-55.8628189796946;-42.4939240081038;-10.0698623549644;-18.0053527635494;-29.5593620035057;-31.7487882131541;-33.5797751982394;-2.98350924789792;-22.0800113226145;-49.5043815771539;-21.8898554446381;-21.7661736835464;-23.9877510574346;-26.5929097901839;-21.4553171433861;-22.3593444231020;-12.4755903494130;-12.0988152670757;-19.3121708056375;-20.9672687065106;-30.9662445238964;-7.62232652105696;-23.3076563868513;-42.0317209205170;-29.9008440260188;2.63653680729057;-8.77530445589909;51.3193616205633;-12.3359078840458;-22.0480377302904;2.32394503106800;-5.84833056926331;7.97464741520346;23.6359159796925;13.6931607086748;-12.0843929510947;-19.8628529751751;-7.31282968255438;-23.2034202603203;17.8734445489383;22.8895034515344;-7.61400509293997;14.4114994945308;-4.35009876433665;16.8009652915506;-8.07277923664781;-19.1545675114943;-0.904961001679325;11.8739320457830;13.2967051382593;-14.6753720999029;21.9050356933030;-0.246015707149557;-13.8191437721783;10.0742094126381;-18.5714502920755;-46.9222291624728;-37.5282145138918;-10.1596572381933;-9.30221255454077;27.9646041676662;-22.6404589005677;-28.1940411020636;-32.4990765205949;-35.6756039035955;-30.1900593259167;-7.76857301512551;-25.8287619282560;-44.8754966499943;-3.75895126450887;21.2167810738002;-17.0580280345649;-21.8496804068327;-3.97326143907542;-61.2170242500382;-32.8223329734222;-47.1114677117980;-29.7616000929116;-14.8654501934306;-47.1373352773702;-26.2686109285446;-23.6529438028045;-39.6646872799652;-41.8162584702217;-18.0541716271099;-24.8041591229476;-17.7230857592682;-39.6242967044465;-12.4503883010178;-8.89338049900344;15.4828675473674;-26.2099533324362;-51.6135097690959;-44.2728549745465;4.92607932358301;-4.38876055998737;-3.43302825364174;1.75351572381727;1.93872269202318;13.2248432537658;-14.5346245217107;-10.3883650506812;-24.9712539048179;15.9355811931660;13.9198355861105;40.2583602527149;-13.3750853517662;12.3360354400592;17.0176715915538;12.7154342144681;-19.4408508259400;9.20498569290134;37.0962708637046;-1.78941418332673;17.5620851642683;11.8295494430345;37.2312884292025;-4.24379683734347;2.89964854125961;-30.5959178940748;21.0332309618646;50.8075619987254;37.3666528190052;16.2182989303307;13.2729301600100;2.53965603480029;22.9959202249427;40.0165873017717;12.8332033059979;7.63476662141419;15.2424561131665;-3.97046658614504;-10.1246009867534;39.9542221558859;30.6135986443336;41.4507115562164;14.4665392312922;19.0107762568415;25.8119295314610;29.3616063513034;-1.96725564523902;32.3968813390238;24.6803482291473;-14.1026010941249;11.3502394778331;-10.4249866151549;9.11532932415334;-47.5256834753873;16.2902894975020;-21.5054004251531;-15.4642591175549;-49.0264981302033;21.3554487878268;-42.9221407766694;3.30844765565296;-42.1599086259083;-23.4648778604646;-29.1721360976330;-23.9947549673731;-37.0106962213024;-21.3146431337686;-33.5816520603808;-32.8300499488947;-42.4747598028808;-24.5640199325213;-25.1314261193184;-36.1086441240993;9.84141615521449;-4.91134398910347;-45.2247232972867;-39.4127689744033;-18.6680805660205;-41.1714552991819;-69.5481760992560;-53.2593936530652;-15.8012305426508;-28.4349293105836;-48.9687252637104;-34.2509926220452;-1.96406656553586;-29.4292057987402;-28.9505807727967;-43.6992405463325;-22.4668932869203;-73.1916314691551;-58.8604731005928;9.88506642683026;-11.9961146024029;-66.5052330206494;-22.2913414563169;-60.8071347505817;-58.4833012170692;-56.1633837454350;-37.1954390665263;-43.8143097305200;-39.7721170444736;-72.2442522826752;-41.8731213440910;-82.2142787755395;-35.8304068639712;-36.9366416519277;-56.1128941284115;-48.9390251554176;-15.6670751494240;-24.1867511768105;-16.7450779016876;-60.7235688781943;-63.8404987427335;-45.4017741932443;-44.3520138900921;-37.8776189820693;-58.4124145618868;-60.2682301495529;-20.1267957261732;-18.1301285861659;-30.5488386011914;-26.0983952011158;-72.9265035875049;-42.3026591489993;-27.9742793164871;-29.6891706228261;-17.7486609614800;-15.4884376475770;-36.0884103426599;-15.0823647254364;-45.3557144515933;4.00471383802357;-33.8827599054279;1.87460903302546;-59.2311687948404;-17.4680106991928;-20.2228140338177;-2.79046286799585;-36.3068783539556;-17.1989278512959;28.4048196356081;-24.1894530021412;-27.8910266628419;-36.2283069513878;-9.38155667282998;-12.7864284867745;-22.7615561024121;-18.4311213090088;-2.87675956783042;8.98285458233494;-15.9020690799691;-5.84030207541439;29.7416756656699;-28.5765488198964;-40.6460940924675;9.62937093619619;-31.8571350107723;10.1037344821823;-15.4909877667302;-0.797459863305995;-1.15671344682743;11.6371188969904;4.17014386844674;29.1450613311788;-19.5079221141608;7.67686317355504;9.18064917159204;10.9943308800934;-14.3286904162393;25.1091918777839;-7.66612974854380;-1.62315662848035;9.70411366237632;13.9152158121002;30.4830118972727;28.2818168105887;44.4375275879696;20.6347592322694;25.5975475581288;19.2390383962792;12.2993127443892;-0.225523861177479;30.8069297958668;28.6866948624783;-3.72924452333458;36.8311332239872;13.1751354045906;19.3547292318642;20.2517054405525;41.7162192161920;29.0694296486939;13.4399416290032;12.6124811208602;37.3262438202899;16.0752549922074;19.3823512200654;24.3791432206799;18.5770879678740;39.7458412173406];
s = [-1;-2;-3;-4;-5;-6;-7;-8;-9;-10;-11;-12;-13;-14;-15;-16;-17;-18;-19;-20;-21;-22;-23;-24;-25;-26;-27;-28;-29;-30;-31;-32;-33;-34;-35;-36;-37;-38;-39;-40;-41;-42;-43;-44;-45;-46;-47;-48;-49;-50;-51;-52;-53;-54;-55;-54;-53;-52;-51;-50;-49;-48;-47;-46;-45;-44;-43;-42;-41;-40;-39;-38;-37;-36;-35;-34;-33;-32;-31;-30;-29;-28;-27;-26;-25;-24;-23;-22;-21;-20;-19;-18;-17;-16;-15;-14;-13;-12;-11;-10;-9;-8;-7;-8;-9;-10;-11;-12;-13;-14;-15;-16;-17;-18;-19;-20;-21;-22;-23;-24;-25;-26;-27;-28;-29;-30;-31;-32;-33;-34;-35;-36;-37;-38;-39;-40;-41;-42;-43;-44;-45;-46;-47;-48;-49;-50;-51;-52;-53;-54;-55;-56;-57;-58;-59;-60;-61;-62;-63;-64;-65;-66;-67;-68;-69;-70;-71;-72;-73;-74;-75;-76;-77;-78;-79;-80;-81;-82;-83;-82;-81;-80;-79;-78;-77;-76;-75;-74;-73;-72;-71;-70;-69;-68;-67;-66;-65;-64;-63;-62;-61;-60;-59;-58;-57;-56;-55;-54;-53;-52;-51;-50;-49;-48;-47;-46;-45;-44;-43;-42;-41;-40;-39;-38;-37;-36;-35;-34;-33;-32;-31;-30;-29;-28;-27;-26;-25;-24;-25;-26;-27;-28;-29;-30;-31;-32;-33;-34;-35;-36;-37;-38;-39;-40;-41;-42;-43;-44;-45;-46;-47;-48;-49;-50;-51;-52;-53;-54;-55;-56;-57;-58;-59;-60;-61;-62;-63;-64;-65;-66;-67;-68;-69;-70;-71;-72;-73;-74;-75;-76;-77;-78;-79;-80;-81;-82;-83;-84;-85;-86;-87;-88;-89;-90;-91;-92;-93;-94;-95;-96;-97;-98;-97;-96;-95;-94;-93;-92;-91;-90;-89;-88;-87;-86;-85;-84;-83;-82;-81;-80;-79;-78;-77;-76;-75;-74;-73;-72;-71;-70;-69;-68;-67;-66;-65;-64;-63;-62;-61;-60;-59;-58;-57;-56;-55;-54;-53;-52;-51;-50;-49;-48;-47;-46;-45;-44;-43;-42;-41;-40;-39;-38;-37;-38;-39;-40;-41;-42;-43;-44;-45;-46;-47;-48;-49;-50;-51;-52;-53;-54;-55;-56;-57;-58;-59;-60;-61;-62;-63;-64;-65;-66;-67;-68;-69;-70;-71;-72;-73;-74;-75;-76;-77;-78;-79;-80;-81;-82;-83;-84;-85;-84;-83;-82;-81;-80;-79;-78;-77;-76;-75;-74;-73;-72;-71;-70;-69;-68;-67;-66;-65;-64;-63;-62;-61;-60;-59;-58;-57;-56;-55;-54;-53;-52;-51;-50;-49;-48;-47;-46;-45;-44;-43;-42;-41;-40;-39;-38;-37;-36;-35;-34;-33;-32;-31;-30;-29;-28;-27;-26;-25;-24;-23;-22;-21;-20;-19;-18;-17;-16;-15;-14;-13;-12;-11;-10;-9;-8;-7;-6;-5;-4;-3;-2;-1;0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;34;33;32;31;30;29;28;27;26;25;24;23;22;21;20;19;18;17;16;15;14;13;12;11;10;9;8;7;6;5;4;3;2;1;0;-1;-2;-3;-4;-5;-6;-7;-8;-9;-10;-11;-12;-13;-14;-15;-16;-17;-18;-19;-20;-21;-22;-23;-24;-25;-26;-27;-28;-29;-30;-31;-32;-33;-34;-35;-36;-35;-34;-33;-32;-31;-30;-29;-28;-27;-26;-25;-24;-23;-22;-21;-20;-19;-18;-17;-16;-15;-14;-13;-12;-11;-10;-9;-8;-7;-6;-5;-4;-3;-2;-1;0;1;2;3;4;5;4;3;2;1;0;-1;-2;-3;-4;-5;-6;-7;-8;-9;-10;-11;-12;-13;-14;-15;-16;-17;-18;-19;-20;-21;-22;-23;-24;-25;-26;-27;-28;-27;-26;-25;-24;-23;-22;-21;-20;-19;-18;-17;-16;-15;-14;-13;-12;-11;-10;-9;-8;-7;-6;-5;-4;-3;-2;-1;0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;18;17;16;15;14;13;12;11;10;9;8;7;6;5;4;3;2;1;0;-1;-2;-3;-4;-5;-6;-7;-8;-9;-10;-11;-12;-13;-14;-15;-16;-17;-18;-19;-20;-21;-22;-23;-24;-25;-26;-27;-28;-29;-30;-31;-32;-33;-34;-35;-36;-37;-38;-39;-40;-41;-42;-43;-44;-45;-46;-47;-48;-49;-50;-51;-52;-53;-54;-55;-56;-57;-56;-55;-54;-53;-52;-51;-50;-49;-48;-47;-46;-45;-44;-43;-42;-41;-40;-39;-38;-37;-36;-35;-34;-33;-32;-31;-30;-29;-28;-27;-26;-25;-24;-23;-22;-21;-20;-19;-18;-17;-16;-15;-14;-13;-12;-11;-10;-9;-8;-7;-6;-5;-4;-3;-2;-1;0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39];
%[s,r] = randslopes1(1e+03, 20, 0.9 ,20, 1, 1);
n = 50;
mf = [linspace(0,n,n+1), linspace(n-1,0,n)];
y_mf = conv(r,mf);
[max,maxt] = findpeaks(y_mf);
[min,mint] = findpeaks(-1*y_mf);
figure;
plot(y_mf);
hold on;
scatter(maxt,y_mf(maxt));
hold on;
scatter(mint,y_mf(mint));
hold off;
title('correlation of noisy signal with corner template');
legend('matched filtered','maxima','minima','Location','best');

pn_corners_t = zeros(length(maxt), 1);
for i = 1:length(maxt)
    if maxt(i) - n < 0
        pn_corners_t(i) = maxt(i);
    elseif  maxt(i) - n <= length(r)
        pn_corners_t(i) = maxt(i) - n;
    else
        pn_corners_t = [pn_corners_t(1:i-1,1);pn_corners_t(i+1:end,1)];
    end
end

np_corners_t = zeros(length(mint), 1);
for i = 1:length(mint)
    if mint(i) - n < 0
        np_corners_t(i) = mint(i);
    elseif  mint(i) - n <= length(r)
        np_corners_t(i) = mint(i) - n;
    else
        np_corners_t = [np_corners_t(1:i-1,1);np_corners_t(i+1:end,1)];
    end
end

figure;
subplot(1,2,1);
plot(r);
hold on;
scatter(pn_corners_t,s(pn_corners_t));
hold on;
scatter(np_corners_t,s(np_corners_t));
hold off;
title('received WGN signal');
legend('signal','corner +1->-1','corner -1->+1','Location','best');
subplot(1,2,2);
plot(s);
hold on;
scatter(pn_corners_t,s(pn_corners_t));
hold on;
scatter(np_corners_t,s(np_corners_t));
hold off;
title('transmitted signal');
legend('signal','corner +1->-1','corner -1->+1','Location','best');

